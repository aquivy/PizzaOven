<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Forno de Pizza - RA Mais Estável</title>
  <script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/3.5.0/model-viewer.min.js"></script>
  <style>
    body {
      margin: 0;
      /* Removendo flexbox para o body, o model-viewer vai preencher a tela */
      overflow: hidden; /* Para evitar scroll */
      background-color: #f0f0f0;
      font-family: sans-serif;
    }
    model-viewer {
      /* Tornando o model-viewer visível e preenchendo a tela */
      width: 100vw;
      height: 100vh;
      border: none;
      background-color: #f0f0f0;
    }
    /* Opcional: Para ocultar o texto de status e o botão customizado,
       já que vamos usar o botão nativo do model-viewer. */
    #start-ar-button, #status-text {
      display: none;
    }
  </style>
</head>
<body>
  <button id="start-ar-button" style="display: none;">Iniciar Realidade Aumentada</button>
  <div id="status-text" style="display: none;">Aguardando...</div>

  <model-viewer
    id="pizza-ar-viewer"
    src="pizza oven_resized.glb"
    alt="Forno de Pizza em RA"
    ar                                   ar-modes="webxr scene-viewer quick-look" ar-placement="floor"
    ar-scale="auto"                      shadow-intensity="1"
    exposure="1.0"
    interaction-prompt="none"            camera-controls                      disable-tap="false"                  disable-pan="false"                  autoplay                             loading="eager"                      field-of-view="35deg"                /* Opcional: Adicionar um fallback para navegadores sem JS */
    /* <img src="fallback-image.jpg" alt="Fallback Forno de Pizza"> */
  >
  </model-viewer>

  <script>
    // Remover a maior parte do JavaScript customizado de ativação
    // O model-viewer gerencia o carregamento e a ativação da RA com o atributo 'ar'

    // Opcional: Manter listeners para depuração ou feedback avançado, se necessário
    const modelViewer = document.getElementById('pizza-ar-viewer');

    modelViewer.addEventListener('error', (event) => {
        console.error("Erro no carregamento ou na RA do model-viewer:", event.detail);
        alert(`Ocorreu um erro: ${event.detail.src || 'desconhecido'}. Tente novamente ou verifique a compatibilidade do seu dispositivo/ambiente.`);
    });

    modelViewer.addEventListener('ar-session-end', () => {
        console.log("Sessão de RA finalizada.");
    });

    modelViewer.addEventListener('ar-tracking-limited', (event) => {
        if (event.detail.reason === 'too-few-features') {
            console.warn("Rastreamento AR limitado: Mova o telefone para escanear a superfície.");
        }
    });

    // Se você realmente precisar de um botão customizado para algo mais (ex: um overlay),
    // você pode reintroduzir o JavaScript, mas o 'modelViewer.activateAR()' seria chamado
    // apenas após o model-viewer já estar visível e carregado, e com a interface AR pronta.
    // Para iniciar, é mais seguro deixar o model-viewer gerenciar.
  </script>
</body>
</html>
